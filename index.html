<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>hello world</h1>
    <div class="holder" style="width: 100px;height: 50px;background-color: aqua;"></div>
    <a href="https:\\baidu.com">学习shell对象</a>
    <button class="ipcBtn">触发ipc</button>
    <script>
        // 进程对象
        console.log('env',process.env)
        console.log('arch',process.arch,)
        console.log('getCPUUsage',process.getCPUUsage())
        console.log('version',process.version)
        console.log('versions',process.versions)
        console.log('process',process)

        // 文件对象
        const content = document.querySelector(".holder")
        content.addEventListener("drop",e => {
            e.preventDefault() //阻止默认行为
            console.log(e.dataTransfer)
            console.log(e.dataTransfer.files)
            // 这里注意一下H5原生file实列和electron中file实例的区别，有两个新增属性。
            // 另，files属性是一个临时状态。
            const files = e.dataTransfer.files
            if(files && files.length > 0) {
                const path = files[0].path
                console.log(path)
            }
        })
        content.addEventListener("dragover", e => {
            e.preventDefault()
        })


        // shell对象
        const aTag = document.querySelector("a")
        const {shell} = require("electron")
        aTag.addEventListener("click",e => {
            e.preventDefault()
            const target = aTag.getAttribute("href")
            console.log(aTag,shell)
            console.log(target)
            // shell.openExternal(target)  //使用默认程序处理url，所以官网强调带协议。有第二个参数，
            // shell.openPath("index.html")   //使用默认程序打开文件，本地类的
            // shell.showItemInFolder(".gitignore")  //资源管理器中打开文件
            // shell.moveItemToTrash(".gitignore")  // 移动到回收站，和上面一个一样没玩起来，主要是这里要求fullPath
            shell.beep()   //播放提示音
        })
        
        // 上下文菜单
      const remote = require("electron").remote;
      const { Menu, MenuItem } = remote;
      let menu = new Menu();
      menu.append(
        new MenuItem({
          label: "右键菜单1",
          click() {
            console.log("点击右键菜单1");
          },
        })
      );
      menu.append(
        new MenuItem({
          //   不知道这个设置是干嘛的。
          type: "separator",
        })
      );
      menu.append(
        new MenuItem({
          label: "右键菜单2",
          type: "checkbox",
          checked: true,
        })
      );
      window.addEventListener("contextmenu", (e) => {
        e.preventDefault();
        menu.popup({ window: remote.getCurrentWindow() });
      });

      // ipc通信
      const {ipcRenderer} = require("electron")
      const ipcBtn = document.querySelector(".ipcBtn")
      ipcBtn.addEventListener("click", () => {
        ipcRenderer.send("selfEventa","渲染进程触发")
      })
      ipcRenderer.on("selfEventb",(e,data) => {
        console.log("渲染进程get数据" + JSON.parse(data))
      })
    </script>
</body>
</html>